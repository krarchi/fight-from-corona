<section class="container" ng-controller="issueController">
  <div class="d-flex justify-content-center">

    <div class="d-flex flex-column">
      <div class="form-row">
        <div class="col-md-9 mb-3">
          <label >Category</label>
          <select
              ng-model="selection.category"
              ng-change="onCategoryChange()"
              ng-options="value.id as value.name group by value.group for value in option_categories"
              name="category_id" class="custom-select">
            <option>__</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="col-md-9 mb-3">
          <label >Sub Category</label>
          <select
            ng-model="selection.sub_category" ng-options="value.id as value.name group by value.group for value in sub_categories"
            name="category_sub_id" class="custom-select">
            <option>__</option>
          </select>
        </div>
      </div>

      <form class="needs-validation" novalidate>
        <%= csrf_meta_tag %>
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
        <div class="form-row">
          <div class="col-md-9 mb-3">
            <label for="validationTooltip01">Issue Name</label>
            <input type="text" ng-model="selection.name" class="form-control" id="validationTooltip01" placeholder="Please name your issue" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col-md-9 mb-3">
            <label for="validationTooltip02">Issue Description</label>
            <textarea ng-model="selection.description" type="text" class="form-control" id="validationTooltip02" placeholder="Please describe your issue" required></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="col-md-9 mb-3">
            <label for="validationTooltip03">Address</label>
            <input type="text" ng-model="selection.address" class="form-control" name="address" placeholder="Please provide your address" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col-md-9 mb-3">
            <label for="validationTooltip05">Pincode</label>
            <input type="text" ng-model="selection.pincode" class="form-control" name="pincode" placeholder="Pincode" required>
            <div class="invalid-tooltip">
              Please provide a valid pincode.
            </div>
          </div>
        </div>
        <button class="btn btn-primary" type="button" ng-click="createIssue()">
          <div ng-if="loading" class="ng-cloak">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            <span role="status" aria-hidden="true">Creating Issue...</span>
          </div>
          <span ng-if="!loading" role="status" aria-hidden="true" ng-cloak>Submit Your Issue</span>
        </button>
      </form>
    </div>

  </div>

</section>
